!function(){function e(t,n){if(!(this instanceof e))return new e(t,n);if(!t||"TABLE"!==t.tagName)throw new Error("Element must be a table");this.init(t,n||{})}var t=[],n=function(e){var t;return window.CustomEvent&&"function"==typeof window.CustomEvent?t=new CustomEvent(e):(t=document.createEvent("CustomEvent")).initCustomEvent(e,!1,!1,void 0),t},o=function(e){return e.getAttribute("data-sort")||e.textContent||e.innerText||""},a=function(e,t){return(e=e.trim().toLowerCase())===(t=t.trim().toLowerCase())?0:e<t?1:-1},d=function(e,t){return function(n,o){var a=e(n.td,o.td);return 0===a?t?o.index-n.index:n.index-o.index:a}};e.extend=function(e,n,o){if("function"!=typeof n||"function"!=typeof o)throw new Error("Pattern and sort must be a function");t.push({name:e,pattern:n,sort:o})},e.prototype={init:function(e,t){var n,o,a,d,r=this;if(r.table=e,r.thead=!1,r.options=t,e.rows&&e.rows.length>0)if(e.tHead&&e.tHead.rows.length>0){for(a=0;a<e.tHead.rows.length;a++)if("thead"===e.tHead.rows[a].getAttribute("data-sort-method")){n=e.tHead.rows[a];break}n||(n=e.tHead.rows[e.tHead.rows.length-1]),r.thead=!0}else n=e.rows[0];if(n){var s=function(){r.current&&r.current!==this&&r.current.removeAttribute("aria-sort"),r.current=this,r.sortTable(this)};for(a=0;a<n.cells.length;a++)(d=n.cells[a]).setAttribute("role","columnheader"),"none"!==d.getAttribute("data-sort-method")&&(d.tabindex=0,d.addEventListener("click",s,!1),null!==d.getAttribute("data-sort-default")&&(o=d));o&&(r.current=o,r.sortTable(o))}},sortTable:function(e,r){var s=this,i=e.cellIndex,c=a,l="",u=[],p=s.thead?0:1,m=e.getAttribute("data-sort-method"),h=e.getAttribute("aria-sort");if(s.table.dispatchEvent(n("beforeSort")),r||(h="ascending"===h?"descending":"descending"===h?"ascending":s.options.descending?"descending":"ascending",e.setAttribute("aria-sort",h)),!(s.table.rows.length<2)){if(!m){for(;u.length<3&&p<s.table.tBodies[0].rows.length;)(l=(l=o(s.table.tBodies[0].rows[p].cells[i])).trim()).length>0&&u.push(l),p++;if(!u)return}for(p=0;p<t.length;p++)if(l=t[p],m){if(l.name===m){c=l.sort;break}}else if(u.every(l.pattern)){c=l.sort;break}for(s.col=i,p=0;p<s.table.tBodies.length;p++){var g,f=[],v={},y=0,E=0;if(!(s.table.tBodies[p].rows.length<2)){for(g=0;g<s.table.tBodies[p].rows.length;g++)"none"===(l=s.table.tBodies[p].rows[g]).getAttribute("data-sort-method")?v[y]=l:f.push({tr:l,td:o(l.cells[s.col]),index:y}),y++;for("descending"===h?f.sort(d(c,!0)):(f.sort(d(c,!1)),f.reverse()),g=0;g<y;g++)v[g]?(l=v[g],E++):l=f[g-E].tr,s.table.tBodies[p].appendChild(l)}}s.table.dispatchEvent(n("afterSort"))}},refresh:function(){void 0!==this.current&&this.sortTable(this.current,!0)}},"undefined"!=typeof module&&module.exports?module.exports=e:window.Tablesort=e}(),function(){var e=function(e){return e.replace(/[^\-?0-9.]/g,"")};Tablesort.extend("number",function(e){return e.match(/^[-+]?[£\x24Û¢´€]?\d+\s*([,\.]\d{0,2})/)||e.match(/^[-+]?\d+\s*([,\.]\d{0,2})?[£\x24Û¢´€]/)||e.match(/^[-+]?(\d)*-?([,\.]){0,1}-?(\d)+([E,e][\-+][\d]+)?%?$/)},function(t,n){return t=e(t),function(e,t){return e=parseFloat(e),t=parseFloat(t),(e=isNaN(e)?0:e)-(t=isNaN(t)?0:t)}(n=e(n),t)})}();const profile=document.querySelector(".profile");let userId=null,year=null;function getUserId(){const e=document.querySelector(".current h1");null!==e&&(userId=e.dataset.id)}function getYear(){const e=document.querySelector(".yearHeader");null!==e&&(year=e.dataset.year)}function updateProfile(e){if(console.log(e),removeSpinnerIfPresent(),null!==e.logs||0!==e.events.length)null!==e.logs&&printLogs(e.logs),0!==e.events.length&&printEvents(e.events);else{const e=createNotification();profile.appendChild(e)}}function printLogs(e){const t=document.createElement("section");t.classList.add("table");const n=document.createElement("table"),o=document.createElement("thead"),a=document.createElement("tr"),d=document.createElement("th");d.classList.add("icon");const r=document.createElement("th");r.appendChild(document.createTextNode("Level")),r.classList.add("level");const s=document.createElement("th");s.appendChild(document.createTextNode("Experience"));const i=document.createElement("th");i.appendChild(document.createTextNode("Difference"));const c=document.createElement("tbody");profile.appendChild(t),t.appendChild(n),n.appendChild(o),a.appendChild(d),a.appendChild(r),a.appendChild(s),a.appendChild(i),o.appendChild(a),n.appendChild(c),e.forEach(function(e,t){const n=document.createElement("tr"),o=document.createElement("td"),a=document.createElement("span");a.classList.add("log-icon","s"+t),o.appendChild(a);const d=document.createElement("td");d.appendChild(document.createTextNode(e.level));const r=document.createElement("td");r.appendChild(document.createTextNode(Math.round(e.value).toLocaleString()));const s=document.createElement("td");e.difference>0?(s.appendChild(document.createTextNode("+"+Math.round(e.difference).toLocaleString())),s.classList.add("log-value","positive")):s.appendChild(document.createTextNode("0")),n.appendChild(o),n.appendChild(d),n.appendChild(r),n.appendChild(s),c.appendChild(n)})}function printEvents(e){const t=document.createElement("section");t.classList.add("events");const n=document.createElement("ul");n.classList.add("events"),profile.appendChild(t),t.appendChild(n),e.forEach(function(e,t){const o=document.createElement("li");o.classList.add("event-item");const a=document.createElement("div");a.classList.add("event-header");const d=document.createElement("h2");d.appendChild(document.createTextNode(e.title)),d.classList.add("event-title");const r=document.createElement("span");r.appendChild(document.createTextNode(dayjs.unix(e.timestamp).format("MMMM D, YYYY HH:mm"))),r.classList.add("event-timestamp");const s=document.createElement("p");s.appendChild(document.createTextNode(e.details)),s.classList.add("event-details"),o.appendChild(a),a.appendChild(d),a.appendChild(r),o.appendChild(s),n.appendChild(o)})}function createNotification(){const e=document.createElement("div");e.classList.add("text","notification","inf");const t=document.createElement("h2");t.appendChild(document.createTextNode("Nothing interesting happened."));const n=document.createElement("p");return n.appendChild(document.createTextNode("Looks like we don't have any data for you on this day.")),e.appendChild(t),e.appendChild(n),e}const body=document.querySelector("body");let isNightmode=body.classList.contains("is-nightmode");const nightmodeToggle=document.querySelector(".night-mode-toggle");function toggleNightmodeOnClick(e){e.preventDefault(),isNightmode=!(isNightmode=body.classList.contains("is-nightmode")),body.classList.toggle("is-nightmode"),localStorage.setItem("nightmode",JSON.stringify(isNightmode))}function turnOnNightmodeOnPageLoad(){"true"===localStorage.getItem("nightmode")&&body.classList.toggle("is-nightmode")}let startDay,endDay;null!==nightmodeToggle&&nightmodeToggle.addEventListener("click",toggleNightmodeOnClick);let dragged=!1;const gridSquares=document.querySelectorAll(".day");function gridStartHandler(e){startDay=e.target.dataset.index,document.querySelectorAll(".today").forEach(function(e,t){e.classList.toggle("today")}),document.querySelectorAll(".select").forEach(function(e,t){e.classList.toggle("select")}),e.target.classList.toggle("today"),dragged=!0}function gridEndHandler(e){e.preventDefault(),endDay=e.target.dataset.index,dragged=!1,startDay>endDay?load(endDay,startDay):load(startDay,endDay)}function gridHoverHandler(e){dragged&&gridSquares.forEach(function(t,n){t.classList.remove("select"),parseInt(startDay)>parseInt(e.target.dataset.index)?parseInt(t.dataset.index)<=parseInt(startDay)&&parseInt(t.dataset.index)>=parseInt(e.target.dataset.index)&&t.classList.add("select"):parseInt(t.dataset.index)>=parseInt(startDay)&&parseInt(t.dataset.index)<=parseInt(e.target.dataset.index)&&t.classList.add("select")})}function removeSpinnerIfPresent(){const e=document.querySelector(".spinner");null!==e&&e.remove()}function removeNotificationIfPresent(){const e=document.querySelector(".notification");null!==e&&e.remove()}function load(e,t){const n={userId:userId,year:year,startDay:e,endDay:t};profile.innerHTML="",removeNotificationIfPresent(),removeSpinnerIfPresent();const o=document.createElement("span");o.classList.add("spinner"),profile.appendChild(o);const a=new XMLHttpRequest;a.open("POST","/api/getData",!0),a.setRequestHeader("Content-Type","application/json; charset=UTF-8"),a.send(JSON.stringify(n)),a.onreadystatechange=function(){4===a.readyState&&200===a.status&&(console.log(a.responseText),console.log(JSON.parse(a.responseText)),updateProfile(JSON.parse(a.responseText)),sortProfileTable())}}function sortProfileTable(){const e=document.querySelector(".table table");null!==e&&new Tablesort(e,{descending:!0})}gridSquares.length>0&&gridSquares.forEach(function(e,t){["mousedown","touchstart"].forEach(function(t){e.addEventListener(t,gridStartHandler)}),["mouseup","touchend"].forEach(function(t){e.addEventListener(t,gridEndHandler)}),["mouseenter","touchenter"].forEach(function(t){e.addEventListener(t,gridHoverHandler)})}),getUserId(),getYear(),turnOnNightmodeOnPageLoad(),sortProfileTable();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRhYmxlc29ydC5taW4uanMiLCJzY3JpcHQuanMiXSwibmFtZXMiOlsiYSIsImIiLCJjIiwidGhpcyIsInRhZ05hbWUiLCJFcnJvciIsImluaXQiLCJ3aW5kb3ciLCJDdXN0b21FdmVudCIsImRvY3VtZW50IiwiY3JlYXRlRXZlbnQiLCJpbml0Q3VzdG9tRXZlbnQiLCJkIiwiZ2V0QXR0cmlidXRlIiwidGV4dENvbnRlbnQiLCJpbm5lclRleHQiLCJlIiwidHJpbSIsInRvTG93ZXJDYXNlIiwiZiIsInRkIiwiaW5kZXgiLCJleHRlbmQiLCJwdXNoIiwibmFtZSIsInBhdHRlcm4iLCJzb3J0IiwicHJvdG90eXBlIiwiZyIsInRhYmxlIiwidGhlYWQiLCJvcHRpb25zIiwicm93cyIsImxlbmd0aCIsInRIZWFkIiwiaCIsImN1cnJlbnQiLCJyZW1vdmVBdHRyaWJ1dGUiLCJzb3J0VGFibGUiLCJjZWxscyIsInNldEF0dHJpYnV0ZSIsInRhYmluZGV4IiwiYWRkRXZlbnRMaXN0ZW5lciIsImkiLCJjZWxsSW5kZXgiLCJqIiwiayIsImwiLCJtIiwibiIsIm8iLCJkaXNwYXRjaEV2ZW50IiwiZGVzY2VuZGluZyIsInRCb2RpZXMiLCJldmVyeSIsImNvbCIsInAiLCJxIiwiciIsInMiLCJ0IiwidHIiLCJyZXZlcnNlIiwiYXBwZW5kQ2hpbGQiLCJyZWZyZXNoIiwibW9kdWxlIiwiZXhwb3J0cyIsIlRhYmxlc29ydCIsImNsZWFuTnVtYmVyIiwicmVwbGFjZSIsIml0ZW0iLCJtYXRjaCIsInBhcnNlRmxvYXQiLCJpc05hTiIsImNvbXBhcmVOdW1iZXIiLCJwcm9maWxlIiwicXVlcnlTZWxlY3RvciIsInVzZXJJZCIsInllYXIiLCJnZXRVc2VySWQiLCJ1c2VySGVhZGVyIiwiZGF0YXNldCIsImlkIiwiZ2V0WWVhciIsInllYXJIZWFkZXIiLCJ1cGRhdGVQcm9maWxlIiwiZGF0YSIsImNvbnNvbGUiLCJsb2ciLCJyZW1vdmVTcGlubmVySWZQcmVzZW50IiwibG9ncyIsImV2ZW50cyIsInByaW50TG9ncyIsInByaW50RXZlbnRzIiwibm90aWZpY2F0aW9uIiwiY3JlYXRlTm90aWZpY2F0aW9uIiwibG9nU2VjdGlvbiIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJsb2dUYWJsZSIsImxvZ0hlYWRlciIsImxvZ0hlYWRlclJvdyIsImxvZ0hlYWRlckljb24iLCJsb2dIZWFkZXJMZXZlbCIsImNyZWF0ZVRleHROb2RlIiwibG9nSGVhZGVyRXhwZXJpZW5jZSIsImxvZ0hlYWRlckRpZmZlcmVuY2UiLCJsb2dUYWJsZUJvZHkiLCJmb3JFYWNoIiwibG9nUm93IiwibG9nSWNvbkNlbGwiLCJsb2dJY29uIiwibG9nTGV2ZWwiLCJsZXZlbCIsImxvZ1ZhbHVlIiwiTWF0aCIsInJvdW5kIiwidmFsdWUiLCJ0b0xvY2FsZVN0cmluZyIsImxvZ0RpZmZlcmVuY2UiLCJkaWZmZXJlbmNlIiwiZXZlbnRTZWN0aW9uIiwiZXZlbnRMaXN0IiwiZXZlbnQiLCJldmVudEl0ZW0iLCJldmVudEhlYWRlciIsImV2ZW50VGl0bGUiLCJ0aXRsZSIsImV2ZW50VGltZXN0YW1wIiwiZGF5anMiLCJ1bml4IiwidGltZXN0YW1wIiwiZm9ybWF0IiwiZXZlbnREZXRhaWxzIiwiZGV0YWlscyIsIm5vdGlmaWNhdGlvblRpdGxlIiwibm90aWZpY2F0aW9uVGV4dCIsImJvZHkiLCJpc05pZ2h0bW9kZSIsImNvbnRhaW5zIiwibmlnaHRtb2RlVG9nZ2xlIiwidG9nZ2xlTmlnaHRtb2RlT25DbGljayIsInByZXZlbnREZWZhdWx0IiwidG9nZ2xlIiwibG9jYWxTdG9yYWdlIiwic2V0SXRlbSIsIkpTT04iLCJzdHJpbmdpZnkiLCJ0dXJuT25OaWdodG1vZGVPblBhZ2VMb2FkIiwiZ2V0SXRlbSIsInN0YXJ0RGF5IiwiZW5kRGF5IiwiZHJhZ2dlZCIsImdyaWRTcXVhcmVzIiwicXVlcnlTZWxlY3RvckFsbCIsImdyaWRTdGFydEhhbmRsZXIiLCJ0YXJnZXQiLCJzcXVhcmUiLCJncmlkRW5kSGFuZGxlciIsImxvYWQiLCJncmlkSG92ZXJIYW5kbGVyIiwicmVtb3ZlIiwicGFyc2VJbnQiLCJzcGlubmVyIiwicmVtb3ZlTm90aWZpY2F0aW9uSWZQcmVzZW50IiwiaW5uZXJIVE1MIiwibmV3U3Bpbm5lciIsInhociIsIlhNTEh0dHBSZXF1ZXN0Iiwib3BlbiIsInNldFJlcXVlc3RIZWFkZXIiLCJzZW5kIiwib25yZWFkeXN0YXRlY2hhbmdlIiwicmVhZHlTdGF0ZSIsInN0YXR1cyIsInJlc3BvbnNlVGV4dCIsInBhcnNlIiwic29ydFByb2ZpbGVUYWJsZSIsInByb2ZpbGVUYWJsZSJdLCJtYXBwaW5ncyI6IkNBSUcsV0FBVyxTQUFTQSxFQUFFQyxFQUFFQyxHQUFHLEtBQUtDLGdCQUFnQkgsR0FBRyxPQUFPLElBQUlBLEVBQUVDLEVBQUVDLEdBQUcsSUFBSUQsR0FBRyxVQUFVQSxFQUFFRyxRQUFRLE1BQU0sSUFBSUMsTUFBTSwyQkFBMkJGLEtBQUtHLEtBQUtMLEVBQUVDLEdBQUcsSUFBSSxJQUFJRCxFQUFFLEdBQUdDLEVBQUUsU0FBU0YsR0FBRyxJQUFJQyxFQUFFLE9BQU9NLE9BQU9DLGFBQWEsbUJBQW1CRCxPQUFPQyxZQUFZUCxFQUFFLElBQUlPLFlBQVlSLElBQUlDLEVBQUVRLFNBQVNDLFlBQVksZ0JBQWlCQyxnQkFBZ0JYLEdBQUUsR0FBRyxPQUFHLEdBQVNDLEdBQUdXLEVBQUUsU0FBU1osR0FBRyxPQUFPQSxFQUFFYSxhQUFhLGNBQWNiLEVBQUVjLGFBQWFkLEVBQUVlLFdBQVcsSUFBSUMsRUFBRSxTQUFTaEIsRUFBRUMsR0FBRyxPQUFPRCxFQUFFQSxFQUFFaUIsT0FBT0Msa0JBQWNqQixFQUFFQSxFQUFFZ0IsT0FBT0MsZUFBb0IsRUFBRWxCLEVBQUVDLEVBQUUsR0FBRyxHQUFHa0IsRUFBRSxTQUFTbkIsRUFBRUMsR0FBRyxPQUFPLFNBQVNDLEVBQUVVLEdBQUcsSUFBSUksRUFBRWhCLEVBQUVFLEVBQUVrQixHQUFHUixFQUFFUSxJQUFJLE9BQU8sSUFBSUosRUFBRWYsRUFBRVcs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RCw4QkFDQTVFLHlCQUdBLE1BQU04RSxFQUFhOUosU0FBU3dGLGNBQWMsUUFDMUNzRSxFQUFXckUsVUFBVUMsSUFBSSxXQUN6QnhCLFFBQVFaLFlBQVl3RyxHQUdwQixNQUFNQyxFQUFNLElBQUlDLGVBQ2hCRCxFQUFJRSxLQUFLLE9BQVEsZ0JBQWdCLEdBQ2pDRixFQUFJRyxpQkFBaUIsZUFBZ0IsbUNBQ3JDSCxFQUFJSSxLQUFLekIsS0FBS0MsVUFBVTlELElBQ3hCa0YsRUFBSUssbUJBQXFCLFdBQ0UsSUFBbkJMLEVBQUlNLFlBQW1DLE1BQWZOLEVBQUlPLFNBQzVCeEYsUUFBUUMsSUFBSWdGLEVBQUlRLGNBQ2hCekYsUUFBUUMsSUFBSTJELEtBQUs4QixNQUFNVCxFQUFJUSxlQUMzQjNGLGNBQWM4RCxLQUFLOEIsTUFBTVQsRUFBSVEsZUFDN0JFLHFCQUtaLFNBQVNBLG1CQUVMLE1BQU1DLEVBQWUxSyxTQUFTbUUsY0FBYyxnQkFDdkIsT0FBakJ1RyxHQUNBLElBQUloSCxVQUFVZ0gsRUFBYyxDQUN4Qi9ILFlBQVksSUF2SHBCc0csWUFBWXpILE9BQVMsR0FFckJ5SCxZQUFZN0MsUUFBUSxTQUFVaUQsRUFBUXpJLEdBRWxDLENBQUMsWUFBYSxjQUFjd0YsUUFBUSxTQUFVN0YsR0FDMUM4SSxFQUFPcEgsaUJBQWlCMUIsRUFBRzRJLG9CQUcvQixDQUFDLFVBQVcsWUFBWS9DLFFBQVEsU0FBVTdGLEdBQ3RDOEksRUFBT3BILGlCQUFpQjFCLEVBQUcrSSxrQkFHL0IsQ0FBQyxhQUFjLGNBQWNsRCxRQUFRLFNBQVU3RixHQUMzQzhJLEVBQU9wSCxpQkFBaUIxQixFQUFHaUosc0JBdUh2Q2xGLFlBQ0FJLFVBQ0FrRSw0QkFDQTZCIiwic291cmNlc0NvbnRlbnQiOlsiLyohXG4gKiB0YWJsZXNvcnQgdjUuMC4yICgyMDE3LTExLTEyKVxuICogaHR0cDovL3RyaXN0ZW4uY2EvdGFibGVzb3J0L2RlbW8vXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTcgOyBMaWNlbnNlZCBNSVRcbiovIWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShiLGMpe2lmKCEodGhpcyBpbnN0YW5jZW9mIGEpKXJldHVybiBuZXcgYShiLGMpO2lmKCFifHxcIlRBQkxFXCIhPT1iLnRhZ05hbWUpdGhyb3cgbmV3IEVycm9yKFwiRWxlbWVudCBtdXN0IGJlIGEgdGFibGVcIik7dGhpcy5pbml0KGIsY3x8e30pfXZhciBiPVtdLGM9ZnVuY3Rpb24oYSl7dmFyIGI7cmV0dXJuIHdpbmRvdy5DdXN0b21FdmVudCYmXCJmdW5jdGlvblwiPT10eXBlb2Ygd2luZG93LkN1c3RvbUV2ZW50P2I9bmV3IEN1c3RvbUV2ZW50KGEpOihiPWRvY3VtZW50LmNyZWF0ZUV2ZW50KFwiQ3VzdG9tRXZlbnRcIiksYi5pbml0Q3VzdG9tRXZlbnQoYSwhMSwhMSx2b2lkIDApKSxifSxkPWZ1bmN0aW9uKGEpe3JldHVybiBhLmdldEF0dHJpYnV0ZShcImRhdGEtc29ydFwiKXx8YS50ZXh0Q29udGVudHx8YS5pbm5lclRleHR8fFwiXCJ9LGU9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYT1hLnRyaW0oKS50b0xvd2VyQ2FzZSgpLGI9Yi50cmltKCkudG9Mb3dlckNhc2UoKSxhPT09Yj8wOmE8Yj8xOi0xfSxmPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGZ1bmN0aW9uKGMsZCl7dmFyIGU9YShjLnRkLGQudGQpO3JldHVybiAwPT09ZT9iP2QuaW5kZXgtYy5pbmRleDpjLmluZGV4LWQuaW5kZXg6ZX19O2EuZXh0ZW5kPWZ1bmN0aW9uKGEsYyxkKXtpZihcImZ1bmN0aW9uXCIhPXR5cGVvZiBjfHxcImZ1bmN0aW9uXCIhPXR5cGVvZiBkKXRocm93IG5ldyBFcnJvcihcIlBhdHRlcm4gYW5kIHNvcnQgbXVzdCBiZSBhIGZ1bmN0aW9uXCIpO2IucHVzaCh7bmFtZTphLHBhdHRlcm46Yyxzb3J0OmR9KX0sYS5wcm90b3R5cGU9e2luaXQ6ZnVuY3Rpb24oYSxiKXt2YXIgYyxkLGUsZixnPXRoaXM7aWYoZy50YWJsZT1hLGcudGhlYWQ9ITEsZy5vcHRpb25zPWIsYS5yb3dzJiZhLnJvd3MubGVuZ3RoPjApaWYoYS50SGVhZCYmYS50SGVhZC5yb3dzLmxlbmd0aD4wKXtmb3IoZT0wO2U8YS50SGVhZC5yb3dzLmxlbmd0aDtlKyspaWYoXCJ0aGVhZFwiPT09YS50SGVhZC5yb3dzW2VdLmdldEF0dHJpYnV0ZShcImRhdGEtc29ydC1tZXRob2RcIikpe2M9YS50SGVhZC5yb3dzW2VdO2JyZWFrfWN8fChjPWEudEhlYWQucm93c1thLnRIZWFkLnJvd3MubGVuZ3RoLTFdKSxnLnRoZWFkPSEwfWVsc2UgYz1hLnJvd3NbMF07aWYoYyl7dmFyIGg9ZnVuY3Rpb24oKXtnLmN1cnJlbnQmJmcuY3VycmVudCE9PXRoaXMmJmcuY3VycmVudC5yZW1vdmVBdHRyaWJ1dGUoXCJhcmlhLXNvcnRcIiksZy5jdXJyZW50PXRoaXMsZy5zb3J0VGFibGUodGhpcyl9O2ZvcihlPTA7ZTxjLmNlbGxzLmxlbmd0aDtlKyspZj1jLmNlbGxzW2VdLGYuc2V0QXR0cmlidXRlKFwicm9sZVwiLFwiY29sdW1uaGVhZGVyXCIpLFwibm9uZVwiIT09Zi5nZXRBdHRyaWJ1dGUoXCJkYXRhLXNvcnQtbWV0aG9kXCIpJiYoZi50YWJpbmRleD0wLGYuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsaCwhMSksbnVsbCE9PWYuZ2V0QXR0cmlidXRlKFwiZGF0YS1zb3J0LWRlZmF1bHRcIikmJihkPWYpKTtkJiYoZy5jdXJyZW50PWQsZy5zb3J0VGFibGUoZCkpfX0sc29ydFRhYmxlOmZ1bmN0aW9uKGEsZyl7dmFyIGg9dGhpcyxpPWEuY2VsbEluZGV4LGo9ZSxrPVwiXCIsbD1bXSxtPWgudGhlYWQ/MDoxLG49YS5nZXRBdHRyaWJ1dGUoXCJkYXRhLXNvcnQtbWV0aG9kXCIpLG89YS5nZXRBdHRyaWJ1dGUoXCJhcmlhLXNvcnRcIik7aWYoaC50YWJsZS5kaXNwYXRjaEV2ZW50KGMoXCJiZWZvcmVTb3J0XCIpKSxnfHwobz1cImFzY2VuZGluZ1wiPT09bz9cImRlc2NlbmRpbmdcIjpcImRlc2NlbmRpbmdcIj09PW8/XCJhc2NlbmRpbmdcIjpoLm9wdGlvbnMuZGVzY2VuZGluZz9cImRlc2NlbmRpbmdcIjpcImFzY2VuZGluZ1wiLGEuc2V0QXR0cmlidXRlKFwiYXJpYS1zb3J0XCIsbykpLCEoaC50YWJsZS5yb3dzLmxlbmd0aDwyKSl7aWYoIW4pe2Zvcig7bC5sZW5ndGg8MyYmbTxoLnRhYmxlLnRCb2RpZXNbMF0ucm93cy5sZW5ndGg7KWs9ZChoLnRhYmxlLnRCb2RpZXNbMF0ucm93c1ttXS5jZWxsc1tpXSksaz1rLnRyaW0oKSxrLmxlbmd0aD4wJiZsLnB1c2goayksbSsrO2lmKCFsKXJldHVybn1mb3IobT0wO208Yi5sZW5ndGg7bSsrKWlmKGs9YlttXSxuKXtpZihrLm5hbWU9PT1uKXtqPWsuc29ydDticmVha319ZWxzZSBpZihsLmV2ZXJ5KGsucGF0dGVybikpe2o9ay5zb3J0O2JyZWFrfWZvcihoLmNvbD1pLG09MDttPGgudGFibGUudEJvZGllcy5sZW5ndGg7bSsrKXt2YXIgcCxxPVtdLHI9e30scz0wLHQ9MDtpZighKGgudGFibGUudEJvZGllc1ttXS5yb3dzLmxlbmd0aDwyKSl7Zm9yKHA9MDtwPGgudGFibGUudEJvZGllc1ttXS5yb3dzLmxlbmd0aDtwKyspaz1oLnRhYmxlLnRCb2RpZXNbbV0ucm93c1twXSxcIm5vbmVcIj09PWsuZ2V0QXR0cmlidXRlKFwiZGF0YS1zb3J0LW1ldGhvZFwiKT9yW3NdPWs6cS5wdXNoKHt0cjprLHRkOmQoay5jZWxsc1toLmNvbF0pLGluZGV4OnN9KSxzKys7Zm9yKFwiZGVzY2VuZGluZ1wiPT09bz9xLnNvcnQoZihqLCEwKSk6KHEuc29ydChmKGosITEpKSxxLnJldmVyc2UoKSkscD0wO3A8cztwKyspcltwXT8oaz1yW3BdLHQrKyk6az1xW3AtdF0udHIsaC50YWJsZS50Qm9kaWVzW21dLmFwcGVuZENoaWxkKGspfX1oLnRhYmxlLmRpc3BhdGNoRXZlbnQoYyhcImFmdGVyU29ydFwiKSl9fSxyZWZyZXNoOmZ1bmN0aW9uKCl7dm9pZCAwIT09dGhpcy5jdXJyZW50JiZ0aGlzLnNvcnRUYWJsZSh0aGlzLmN1cnJlbnQsITApfX0sXCJ1bmRlZmluZWRcIiE9dHlwZW9mIG1vZHVsZSYmbW9kdWxlLmV4cG9ydHM/bW9kdWxlLmV4cG9ydHM9YTp3aW5kb3cuVGFibGVzb3J0PWF9KCk7XG5cbihmdW5jdGlvbigpe1xuICAgIHZhciBjbGVhbk51bWJlciA9IGZ1bmN0aW9uKGkpIHtcbiAgICAgICAgICAgIHJldHVybiBpLnJlcGxhY2UoL1teXFwtPzAtOS5dL2csICcnKTtcbiAgICAgICAgfSxcblxuICAgICAgICBjb21wYXJlTnVtYmVyID0gZnVuY3Rpb24oYSwgYikge1xuICAgICAgICAgICAgYSA9IHBhcnNlRmxvYXQoYSk7XG4gICAgICAgICAgICBiID0gcGFyc2VGbG9hdChiKTtcblxuICAgICAgICAgICAgYSA9IGlzTmFOKGEpID8gMCA6IGE7XG4gICAgICAgICAgICBiID0gaXNOYU4oYikgPyAwIDogYjtcblxuICAgICAgICAgICAgcmV0dXJuIGEgLSBiO1xuICAgICAgICB9O1xuXG4gICAgVGFibGVzb3J0LmV4dGVuZCgnbnVtYmVyJywgZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICByZXR1cm4gaXRlbS5tYXRjaCgvXlstK10/W8KjXFx4MjTDm8KiwrTigqxdP1xcZCtcXHMqKFssXFwuXVxcZHswLDJ9KS8pIHx8IC8vIFByZWZpeGVkIGN1cnJlbmN5XG4gICAgICAgICAgICBpdGVtLm1hdGNoKC9eWy0rXT9cXGQrXFxzKihbLFxcLl1cXGR7MCwyfSk/W8KjXFx4MjTDm8KiwrTigqxdLykgfHwgLy8gU3VmZml4ZWQgY3VycmVuY3lcbiAgICAgICAgICAgIGl0ZW0ubWF0Y2goL15bLStdPyhcXGQpKi0/KFssXFwuXSl7MCwxfS0/KFxcZCkrKFtFLGVdW1xcLStdW1xcZF0rKT8lPyQvKTsgLy8gTnVtYmVyXG4gICAgfSwgZnVuY3Rpb24oYSwgYikge1xuICAgICAgICBhID0gY2xlYW5OdW1iZXIoYSk7XG4gICAgICAgIGIgPSBjbGVhbk51bWJlcihiKTtcblxuICAgICAgICByZXR1cm4gY29tcGFyZU51bWJlcihiLCBhKTtcbiAgICB9KTtcbn0oKSk7IiwiLypcbiAqIFJ1bmVsb2dzIHNjcmlwdC5qc1xuICpcbiAqIENvbnRlbnQ6XG4gKiAgLSBHZXQgdXNlcklkIGFuZCBjdXJyZW50IHllYXIgZnJvbSB0aGUgYXBwcm9wcmlhdGUgaGVhZGVyc1xuICogIC0gR3JpZCBzcXVhcmUgY2xpY2sgZXZlbnQgLT4gWGhSIHJlcXVlc3QgbmFhciBBUEkgLT4gdXBkYXRlIHByb2ZpbGVcbiAqICAtIE5pZ2h0bW9kZSB0b2dnbGUgKHdvcmtzIHdpdGggbG9jYWxTdG9yYWdlKVxuICogIC0gR3JpZCBkcmFnIC0+IHNlbGVjdCBzcXVhcmVzXG4gKiAgLSBQcmludCBhIHRhYmxlIHdpdGggcm93cyBmb3IgZXhwIG9yIGFuIHVub3JkZW5lZCBsb3N0IGZvciBldmVudHNcbiAqXG4gKi9cblxuY29uc3QgcHJvZmlsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlJyk7XG5sZXQgdXNlcklkID0gbnVsbDtcbmxldCB5ZWFyID0gbnVsbDtcblxuZnVuY3Rpb24gZ2V0VXNlcklkKCkge1xuICAgIGNvbnN0IHVzZXJIZWFkZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY3VycmVudCBoMScpO1xuICAgIGlmICh1c2VySGVhZGVyICE9PSBudWxsKSB7XG4gICAgICAgIHVzZXJJZCA9IHVzZXJIZWFkZXIuZGF0YXNldC5pZDtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGdldFllYXIoKSB7XG4gICAgY29uc3QgeWVhckhlYWRlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy55ZWFySGVhZGVyJyk7XG4gICAgaWYgKHllYXJIZWFkZXIgIT09IG51bGwpIHtcbiAgICAgICAgeWVhciA9IHllYXJIZWFkZXIuZGF0YXNldC55ZWFyO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gdXBkYXRlUHJvZmlsZShkYXRhKVxue1xuICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgIHJlbW92ZVNwaW5uZXJJZlByZXNlbnQoKTtcblxuICAgIGlmIChkYXRhLmxvZ3MgID09PSBudWxsICYmIGRhdGEuZXZlbnRzLmxlbmd0aCAgPT09IDApIHtcbiAgICAgICAgY29uc3Qgbm90aWZpY2F0aW9uID0gY3JlYXRlTm90aWZpY2F0aW9uKCk7XG4gICAgICAgIHByb2ZpbGUuYXBwZW5kQ2hpbGQobm90aWZpY2F0aW9uKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChkYXRhLmxvZ3MgICE9PSBudWxsKSB7XG4gICAgICAgIHByaW50TG9ncyhkYXRhLmxvZ3MpO1xuICAgIH1cblxuICAgIGlmIChkYXRhLmV2ZW50cy5sZW5ndGggICE9PSAwKSB7XG4gICAgICAgIHByaW50RXZlbnRzKGRhdGEuZXZlbnRzKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHByaW50TG9ncyhsb2dzKVxue1xuICAgIC8vIFByaW50IHRoZSBleHBlcmllbmNlIHRhYmxlIGFuZCBoZWFkZXJcbiAgICBjb25zdCBsb2dTZWN0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2VjdGlvbicpO1xuICAgIGxvZ1NlY3Rpb24uY2xhc3NMaXN0LmFkZCgndGFibGUnKTtcblxuICAgIGNvbnN0IGxvZ1RhYmxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGFibGUnKTtcbiAgICBjb25zdCBsb2dIZWFkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0aGVhZCcpO1xuXG4gICAgY29uc3QgbG9nSGVhZGVyUm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndHInKTtcblxuICAgIGNvbnN0IGxvZ0hlYWRlckljb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0aCcpO1xuICAgIGxvZ0hlYWRlckljb24uY2xhc3NMaXN0LmFkZCgnaWNvbicpO1xuXG4gICAgY29uc3QgbG9nSGVhZGVyTGV2ZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0aCcpO1xuICAgIGxvZ0hlYWRlckxldmVsLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKCdMZXZlbCcpKTtcbiAgICBsb2dIZWFkZXJMZXZlbC5jbGFzc0xpc3QuYWRkKCdsZXZlbCcpO1xuXG4gICAgY29uc3QgbG9nSGVhZGVyRXhwZXJpZW5jZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RoJyk7XG4gICAgbG9nSGVhZGVyRXhwZXJpZW5jZS5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSgnRXhwZXJpZW5jZScpKTtcblxuICAgIGNvbnN0IGxvZ0hlYWRlckRpZmZlcmVuY2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0aCcpO1xuICAgIGxvZ0hlYWRlckRpZmZlcmVuY2UuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoJ0RpZmZlcmVuY2UnKSk7XG5cbiAgICBjb25zdCBsb2dUYWJsZUJvZHkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0Ym9keScpO1xuXG4gICAgcHJvZmlsZS5hcHBlbmRDaGlsZChsb2dTZWN0aW9uKTtcbiAgICBsb2dTZWN0aW9uLmFwcGVuZENoaWxkKGxvZ1RhYmxlKTtcbiAgICBsb2dUYWJsZS5hcHBlbmRDaGlsZChsb2dIZWFkZXIpO1xuXG4gICAgbG9nSGVhZGVyUm93LmFwcGVuZENoaWxkKGxvZ0hlYWRlckljb24pO1xuICAgIGxvZ0hlYWRlclJvdy5hcHBlbmRDaGlsZChsb2dIZWFkZXJMZXZlbCk7XG4gICAgbG9nSGVhZGVyUm93LmFwcGVuZENoaWxkKGxvZ0hlYWRlckV4cGVyaWVuY2UpO1xuICAgIGxvZ0hlYWRlclJvdy5hcHBlbmRDaGlsZChsb2dIZWFkZXJEaWZmZXJlbmNlKTtcblxuICAgIGxvZ0hlYWRlci5hcHBlbmRDaGlsZChsb2dIZWFkZXJSb3cpO1xuXG4gICAgbG9nVGFibGUuYXBwZW5kQ2hpbGQobG9nVGFibGVCb2R5KTtcblxuICAgIC8qIERpc3BsYXkgdGhlIGV4cGVyaWVuY2UgdGFibGUgcm93cyAqL1xuICAgIGxvZ3MuZm9yRWFjaChmdW5jdGlvbiAobG9nLCBpbmRleCkge1xuICAgICAgICBjb25zdCBsb2dSb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0cicpO1xuXG4gICAgICAgIGNvbnN0IGxvZ0ljb25DZWxsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGQnKTtcbiAgICAgICAgY29uc3QgbG9nSWNvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICAgICAgbG9nSWNvbi5jbGFzc0xpc3QuYWRkKCdsb2ctaWNvbicsICdzJyArIGluZGV4KTtcbiAgICAgICAgbG9nSWNvbkNlbGwuYXBwZW5kQ2hpbGQobG9nSWNvbik7XG5cbiAgICAgICAgY29uc3QgbG9nTGV2ZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZCcpO1xuICAgICAgICBsb2dMZXZlbC5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShsb2cubGV2ZWwpKTtcblxuICAgICAgICBjb25zdCBsb2dWYWx1ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RkJyk7XG4gICAgICAgIGxvZ1ZhbHVlLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKE1hdGgucm91bmQobG9nLnZhbHVlKS50b0xvY2FsZVN0cmluZygpKSk7XG5cbiAgICAgICAgY29uc3QgbG9nRGlmZmVyZW5jZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RkJyk7XG4gICAgICAgIGlmIChsb2cuZGlmZmVyZW5jZSA+IDApIHtcbiAgICAgICAgICAgIGxvZ0RpZmZlcmVuY2UuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoJysnICsgTWF0aC5yb3VuZChsb2cuZGlmZmVyZW5jZSkudG9Mb2NhbGVTdHJpbmcoKSkpO1xuICAgICAgICAgICAgbG9nRGlmZmVyZW5jZS5jbGFzc0xpc3QuYWRkKCdsb2ctdmFsdWUnLCAncG9zaXRpdmUnKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxvZ0RpZmZlcmVuY2UuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoJzAnKSk7XG4gICAgICAgIH1cblxuICAgICAgICBsb2dSb3cuYXBwZW5kQ2hpbGQobG9nSWNvbkNlbGwpO1xuICAgICAgICBsb2dSb3cuYXBwZW5kQ2hpbGQobG9nTGV2ZWwpO1xuICAgICAgICBsb2dSb3cuYXBwZW5kQ2hpbGQobG9nVmFsdWUpO1xuICAgICAgICBsb2dSb3cuYXBwZW5kQ2hpbGQobG9nRGlmZmVyZW5jZSk7XG4gICAgICAgIGxvZ1RhYmxlQm9keS5hcHBlbmRDaGlsZChsb2dSb3cpO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBwcmludEV2ZW50cyhldmVudHMpXG57XG4gICAgY29uc3QgZXZlbnRTZWN0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2VjdGlvbicpO1xuICAgIGV2ZW50U2VjdGlvbi5jbGFzc0xpc3QuYWRkKCdldmVudHMnKTtcblxuICAgIGNvbnN0IGV2ZW50TGlzdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3VsJyk7XG4gICAgZXZlbnRMaXN0LmNsYXNzTGlzdC5hZGQoJ2V2ZW50cycpO1xuXG4gICAgcHJvZmlsZS5hcHBlbmRDaGlsZChldmVudFNlY3Rpb24pO1xuICAgIGV2ZW50U2VjdGlvbi5hcHBlbmRDaGlsZChldmVudExpc3QpO1xuXG4gICAgZXZlbnRzLmZvckVhY2goZnVuY3Rpb24gKGV2ZW50LCBpbmRleCkge1xuXG4gICAgICAgIGNvbnN0IGV2ZW50SXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XG4gICAgICAgIGV2ZW50SXRlbS5jbGFzc0xpc3QuYWRkKCdldmVudC1pdGVtJyk7XG5cbiAgICAgICAgY29uc3QgZXZlbnRIZWFkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgZXZlbnRIZWFkZXIuY2xhc3NMaXN0LmFkZCgnZXZlbnQtaGVhZGVyJyk7XG5cbiAgICAgICAgY29uc3QgZXZlbnRUaXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gyJyk7XG4gICAgICAgIGV2ZW50VGl0bGUuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoZXZlbnQudGl0bGUpKTtcbiAgICAgICAgZXZlbnRUaXRsZS5jbGFzc0xpc3QuYWRkKCdldmVudC10aXRsZScpO1xuXG4gICAgICAgIGNvbnN0IGV2ZW50VGltZXN0YW1wID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgICAgICBldmVudFRpbWVzdGFtcC5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShkYXlqcy51bml4KGV2ZW50LnRpbWVzdGFtcCkuZm9ybWF0KFwiTU1NTSBELCBZWVlZIEhIOm1tXCIpKSk7XG4gICAgICAgIGV2ZW50VGltZXN0YW1wLmNsYXNzTGlzdC5hZGQoJ2V2ZW50LXRpbWVzdGFtcCcpO1xuXG4gICAgICAgIGNvbnN0IGV2ZW50RGV0YWlscyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgICAgICAgZXZlbnREZXRhaWxzLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGV2ZW50LmRldGFpbHMpKTtcbiAgICAgICAgZXZlbnREZXRhaWxzLmNsYXNzTGlzdC5hZGQoJ2V2ZW50LWRldGFpbHMnKTtcblxuICAgICAgICBldmVudEl0ZW0uYXBwZW5kQ2hpbGQoZXZlbnRIZWFkZXIpO1xuICAgICAgICBldmVudEhlYWRlci5hcHBlbmRDaGlsZChldmVudFRpdGxlKTtcbiAgICAgICAgZXZlbnRIZWFkZXIuYXBwZW5kQ2hpbGQoZXZlbnRUaW1lc3RhbXApO1xuICAgICAgICBldmVudEl0ZW0uYXBwZW5kQ2hpbGQoZXZlbnREZXRhaWxzKTtcblxuICAgICAgICBldmVudExpc3QuYXBwZW5kQ2hpbGQoZXZlbnRJdGVtKTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlTm90aWZpY2F0aW9uKClcbntcbiAgICBjb25zdCBub3RpZmljYXRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBub3RpZmljYXRpb24uY2xhc3NMaXN0LmFkZCgndGV4dCcsICdub3RpZmljYXRpb24nLCAnaW5mJyk7XG5cbiAgICBjb25zdCBub3RpZmljYXRpb25UaXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gyJyk7XG4gICAgbm90aWZpY2F0aW9uVGl0bGUuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoXCJOb3RoaW5nIGludGVyZXN0aW5nIGhhcHBlbmVkLlwiKSk7XG5cbiAgICBjb25zdCBub3RpZmljYXRpb25UZXh0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuICAgIG5vdGlmaWNhdGlvblRleHQuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoXCJMb29rcyBsaWtlIHdlIGRvbid0IGhhdmUgYW55IGRhdGEgZm9yIHlvdSBvbiB0aGlzIGRheS5cIikpO1xuXG4gICAgbm90aWZpY2F0aW9uLmFwcGVuZENoaWxkKG5vdGlmaWNhdGlvblRpdGxlKTtcbiAgICBub3RpZmljYXRpb24uYXBwZW5kQ2hpbGQobm90aWZpY2F0aW9uVGV4dCk7XG4gICAgcmV0dXJuIG5vdGlmaWNhdGlvbjtcbn1cblxuLyogTmlnaHRtb2RlIHRvZ2dsZSAoZ2xvYmFsKSAqL1xuXG5jb25zdCBib2R5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYm9keScpO1xubGV0IGlzTmlnaHRtb2RlID0gYm9keS5jbGFzc0xpc3QuY29udGFpbnMoJ2lzLW5pZ2h0bW9kZScpO1xuY29uc3QgbmlnaHRtb2RlVG9nZ2xlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm5pZ2h0LW1vZGUtdG9nZ2xlJyk7XG5cbmZ1bmN0aW9uIHRvZ2dsZU5pZ2h0bW9kZU9uQ2xpY2soZSkge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgIC8vIEdldCB0aGUgYm9keSBjbGFzcyBhbmQgcmV2ZXJzZSBpdFxuICAgIGlzTmlnaHRtb2RlID0gYm9keS5jbGFzc0xpc3QuY29udGFpbnMoJ2lzLW5pZ2h0bW9kZScpO1xuICAgIGlzTmlnaHRtb2RlID0gIWlzTmlnaHRtb2RlO1xuXG4gICAgLy8gU2V0IHRoZSBib2R5IGNsYXNzIHNvIHRoYXQgdGhlIHN0eWxpbmcgY2hhbmdlc1xuICAgIGJvZHkuY2xhc3NMaXN0LnRvZ2dsZSgnaXMtbmlnaHRtb2RlJyk7XG5cbiAgICAvLyBTdG9yZSB0aGUgYm9vbCBpbiBsb2NhbFN0b3JhZ2VcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcIm5pZ2h0bW9kZVwiLCBKU09OLnN0cmluZ2lmeShpc05pZ2h0bW9kZSkpO1xufVxuXG4vKlxuICogSWYgYSBwYWdlIGlzIGxvYWRlZCBhbmQgdGhlIGxvY2FsU3RvcmFnZSBwYXJhbWV0ZXIgaXMgc2V0IHRvXG4gKiB0cnVlLCB0aGVuIHN3aXRjaCB0aGUgcGFnZSBzdHlsaW5nXG4gKi9cbmZ1bmN0aW9uIHR1cm5Pbk5pZ2h0bW9kZU9uUGFnZUxvYWQoKSB7XG4gICAgaWYgKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwibmlnaHRtb2RlXCIpID09PSBcInRydWVcIikge1xuICAgICAgICBib2R5LmNsYXNzTGlzdC50b2dnbGUoJ2lzLW5pZ2h0bW9kZScpO1xuICAgIH1cbn1cblxuaWYgKG5pZ2h0bW9kZVRvZ2dsZSAhPT0gbnVsbCkge1xuICAgIG5pZ2h0bW9kZVRvZ2dsZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRvZ2dsZU5pZ2h0bW9kZU9uQ2xpY2spO1xufVxuXG4vKiBEYXRlIGNsaWNrZXIgKi9cbmxldCBzdGFydERheSwgZW5kRGF5O1xubGV0IGRyYWdnZWQgPSBmYWxzZTtcblxuLyogU1ZHIEdyaWQgZXZlbnRzICovXG5jb25zdCBncmlkU3F1YXJlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5kYXknKTtcblxuLy8gcXVlcnlTZWxlY3RvckFsbCByZXR1cm5zIGEgTm9kZWxpc3Qgc28gaGF2ZSB0byBjaGVjayBmb3IgbGVuZ3RoXG5pZiAoZ3JpZFNxdWFyZXMubGVuZ3RoID4gMCkge1xuXG4gICAgZ3JpZFNxdWFyZXMuZm9yRWFjaChmdW5jdGlvbiAoc3F1YXJlLCBpbmRleCkge1xuXG4gICAgICAgIFsnbW91c2Vkb3duJywgJ3RvdWNoc3RhcnQnXS5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBzcXVhcmUuYWRkRXZlbnRMaXN0ZW5lcihlLCBncmlkU3RhcnRIYW5kbGVyKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgWydtb3VzZXVwJywgJ3RvdWNoZW5kJ10uZm9yRWFjaChmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgc3F1YXJlLmFkZEV2ZW50TGlzdGVuZXIoZSwgZ3JpZEVuZEhhbmRsZXIpO1xuICAgICAgICB9KTtcblxuICAgICAgICBbJ21vdXNlZW50ZXInLCAndG91Y2hlbnRlciddLmZvckVhY2goZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIHNxdWFyZS5hZGRFdmVudExpc3RlbmVyKGUsIGdyaWRIb3ZlckhhbmRsZXIpO1xuICAgICAgICB9KTtcblxuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBncmlkU3RhcnRIYW5kbGVyKGUpIHtcbiAgICBzdGFydERheSA9IGUudGFyZ2V0LmRhdGFzZXQuaW5kZXg7XG5cbiAgICBjb25zdCBhY3RpdmUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudG9kYXknKTtcbiAgICBhY3RpdmUuZm9yRWFjaChmdW5jdGlvbiAoc3F1YXJlLCBpbmRleCkge1xuICAgICAgICBzcXVhcmUuY2xhc3NMaXN0LnRvZ2dsZSgndG9kYXknKTtcbiAgICB9KVxuICAgIGNvbnN0IHNlbGVjdGVkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnNlbGVjdCcpO1xuICAgIHNlbGVjdGVkLmZvckVhY2goZnVuY3Rpb24gKHNxdWFyZSwgaW5kZXgpIHtcbiAgICAgICAgc3F1YXJlLmNsYXNzTGlzdC50b2dnbGUoJ3NlbGVjdCcpO1xuICAgIH0pXG4gICAgZS50YXJnZXQuY2xhc3NMaXN0LnRvZ2dsZSgndG9kYXknKTtcbiAgICBkcmFnZ2VkID0gdHJ1ZTtcbn1cblxuZnVuY3Rpb24gZ3JpZEVuZEhhbmRsZXIoZSkge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBlbmREYXkgPSBlLnRhcmdldC5kYXRhc2V0LmluZGV4O1xuICAgIGRyYWdnZWQgPSBmYWxzZTtcbiAgICBpZiAoc3RhcnREYXkgPiBlbmREYXkpIHtcbiAgICAgICAgbG9hZChlbmREYXksIHN0YXJ0RGF5KTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBsb2FkKHN0YXJ0RGF5LCBlbmREYXkpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gZ3JpZEhvdmVySGFuZGxlcihlKSB7XG4gICAgaWYgKGRyYWdnZWQpIHtcbiAgICAgICAgZ3JpZFNxdWFyZXMuZm9yRWFjaChmdW5jdGlvbiAoc3F1YXJlLCBpbmRleCkge1xuICAgICAgICAgICAgLy9yZXNldFxuICAgICAgICAgICAgc3F1YXJlLmNsYXNzTGlzdC5yZW1vdmUoJ3NlbGVjdCcpO1xuICAgICAgICAgICAgLy9yaWdodCBkcmFnXG4gICAgICAgICAgICBpZiAocGFyc2VJbnQoc3RhcnREYXkpID4gcGFyc2VJbnQoZS50YXJnZXQuZGF0YXNldC5pbmRleCkpIHtcbiAgICAgICAgICAgICAgICBpZiAocGFyc2VJbnQoc3F1YXJlLmRhdGFzZXQuaW5kZXgpIDw9IHBhcnNlSW50KHN0YXJ0RGF5KSAmJiBwYXJzZUludChzcXVhcmUuZGF0YXNldC5pbmRleCkgPj0gcGFyc2VJbnQoZS50YXJnZXQuZGF0YXNldC5pbmRleCkpIHtcbiAgICAgICAgICAgICAgICAgICAgc3F1YXJlLmNsYXNzTGlzdC5hZGQoJ3NlbGVjdCcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy9sZWZ0IGRyYWdcbiAgICAgICAgICAgICAgICBpZiAocGFyc2VJbnQoc3F1YXJlLmRhdGFzZXQuaW5kZXgpID49IHBhcnNlSW50KHN0YXJ0RGF5KSAmJiBwYXJzZUludChzcXVhcmUuZGF0YXNldC5pbmRleCkgPD0gcGFyc2VJbnQoZS50YXJnZXQuZGF0YXNldC5pbmRleCkpIHtcbiAgICAgICAgICAgICAgICAgICAgc3F1YXJlLmNsYXNzTGlzdC5hZGQoJ3NlbGVjdCcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHJlbW92ZVNwaW5uZXJJZlByZXNlbnQoKSB7XG4gICAgY29uc3Qgc3Bpbm5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zcGlubmVyJyk7XG4gICAgaWYgKHNwaW5uZXIgIT09IG51bGwpIHtcbiAgICAgICAgc3Bpbm5lci5yZW1vdmUoKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHJlbW92ZU5vdGlmaWNhdGlvbklmUHJlc2VudCgpIHtcbiAgICBjb25zdCBub3RpZmljYXRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubm90aWZpY2F0aW9uJyk7XG4gICAgaWYgKG5vdGlmaWNhdGlvbiAhPT0gbnVsbCkge1xuICAgICAgICBub3RpZmljYXRpb24ucmVtb3ZlKCk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBsb2FkKHN0YXJ0RGF5LCBlbmREYXkpIHtcblxuICAgIC8vICBQcmVwIHRoZSBkYXRhIHRoYXQgdGhlIEFQSSBuZWVkc1xuICAgIGNvbnN0IGRhdGEgPSB7XG4gICAgICAgIHVzZXJJZDogdXNlcklkLFxuICAgICAgICB5ZWFyOiB5ZWFyLFxuICAgICAgICBzdGFydERheTogc3RhcnREYXksXG4gICAgICAgIGVuZERheTogZW5kRGF5XG4gICAgfTtcblxuICAgIC8vICBDbGVhbiB1cCB0aGUgcHJvZmlsZSBzbyB3ZSBjYW4gcmUtaW5zZXJ0IHRoZSBuZXcgZGF0YVxuICAgIHByb2ZpbGUuaW5uZXJIVE1MID0gJyc7XG4gICAgcmVtb3ZlTm90aWZpY2F0aW9uSWZQcmVzZW50KCk7XG4gICAgcmVtb3ZlU3Bpbm5lcklmUHJlc2VudCgpO1xuXG4gICAgLy8gIEFkZCB0aGUgbG9hZGluZyBzcGlubmVyXG4gICAgY29uc3QgbmV3U3Bpbm5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICBuZXdTcGlubmVyLmNsYXNzTGlzdC5hZGQoJ3NwaW5uZXInKTtcbiAgICBwcm9maWxlLmFwcGVuZENoaWxkKG5ld1NwaW5uZXIpO1xuXG4gICAgLy8gIFN0YXJ0IHRoZSByZXF1ZXN0XG4gICAgY29uc3QgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgeGhyLm9wZW4oJ1BPU1QnLCAnL2FwaS9nZXREYXRhJywgdHJ1ZSk7XG4gICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoJ0NvbnRlbnQtVHlwZScsICdhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PVVURi04Jyk7XG4gICAgeGhyLnNlbmQoSlNPTi5zdHJpbmdpZnkoZGF0YSkpO1xuICAgIHhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh4aHIucmVhZHlTdGF0ZSA9PT0gNCAmJiB4aHIuc3RhdHVzID09PSAyMDApIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHhoci5yZXNwb25zZVRleHQpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coSlNPTi5wYXJzZSh4aHIucmVzcG9uc2VUZXh0KSk7XG4gICAgICAgICAgICB1cGRhdGVQcm9maWxlKEpTT04ucGFyc2UoeGhyLnJlc3BvbnNlVGV4dCkpO1xuICAgICAgICAgICAgc29ydFByb2ZpbGVUYWJsZSgpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5mdW5jdGlvbiBzb3J0UHJvZmlsZVRhYmxlKClcbntcbiAgICBjb25zdCBwcm9maWxlVGFibGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudGFibGUgdGFibGUnKTtcbiAgICBpZiAocHJvZmlsZVRhYmxlICE9PSBudWxsKSB7XG4gICAgICAgIG5ldyBUYWJsZXNvcnQocHJvZmlsZVRhYmxlLCB7XG4gICAgICAgICAgICBkZXNjZW5kaW5nOiB0cnVlXG4gICAgICAgIH0pO1xuICAgIH1cbn1cblxuLypcbmxldCBncmlkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmdyaWQtY29udGFpbmVyJyk7XG5pZihncmlkKXtcbiAgbGV0IG1heCA9IGdyaWQuc2Nyb2xsV2lkdGggLSBncmlkLmNsaWVudFdpZHRoO1xuICBncmlkLnNjcm9sbExlZnQgPSBtYXg7XG59XG4qL1xuXG5nZXRVc2VySWQoKTtcbmdldFllYXIoKTtcbnR1cm5Pbk5pZ2h0bW9kZU9uUGFnZUxvYWQoKTtcbnNvcnRQcm9maWxlVGFibGUoKTsiXX0=